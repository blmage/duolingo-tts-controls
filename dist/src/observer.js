!function(){"use strict";const e=()=>{},t=e=>"number"==typeof e&&Number.isFinite(e),n=e=>"string"==typeof e,a=Array.isArray,l=e=>"object"==typeof e&&!!e&&!a(e),o=e=>"function"==typeof e,r=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s=e=>{for(let t in e)if(r(e,t))return!1;return!0},i=e=>{let t=null;if("/"===e.charAt(0)&&("/"===e.charAt(1)?e=`https://${e}`:t=e),null===t)try{t=new URL(e).pathname}catch(n){t=e}return t},u=e=>`__duo-toolbox__-${e}`,d=u("global_variables"),c=(e,t)=>(l(window[d])||(window[d]={}),r(window[d],e)?window[d][e]:t),p=(e,t)=>{l(window[d])||(window[d]={}),window[d][e]=t},f=(e,t,n)=>{const a=t(c(e,n));return p(e,a),a},v=(e,t,n,a,l=1)=>{r(window,e)&&t(window[e])?n(window[e]):f("pending_global_listeners",((o={})=>{var r;if(!o[e]){o[e]={};let n=window[e];Object.defineProperty(window,e,{get:()=>n,set:a=>{t(a)?(Object.defineProperty(window,e,{value:a,configurable:!0,enumerable:!0,writable:!0}),Object.values(o[e]).forEach((e=>e.callback(a)))):n=a},configurable:!0})}return l>(Number(null===(r=o[e][a])||void 0===r?void 0:r.version)||0)&&(o[e][a]={callback:n,version:l}),o}))},g=u("original_function"),h=u("override_version"),_=(t,n,a,o=1)=>{var r;if(l(t)&&o>(Number(null===(r=t[n])||void 0===r?void 0:r[h])||0)){var s;const l=(null===(s=t[n])||void 0===s?void 0:s[g])||t[n]||e;t[n]=a(l),t[n][g]=l,t[n][h]=o}},m=(e,t,n,a=1)=>v(e,o,(e=>_(null==e?void 0:e.prototype,t,n,a)),`instance_method:${t}`,a),y=u("logging_iframe"),b=()=>(()=>{let e=document.getElementById(y);return e&&e.isConnected||(e=document.createElement("iframe"),e.id=y,e.style.display="none",document.body.appendChild(e)),e})().contentWindow.console,w=(...e)=>b().error(...e),O=["characterIntro","characterMatch","characterPuzzle","characterSelect","characterTrace","selectPronunciation","selectTranscription"],k=e=>{var t,n;return(null===(t=e.metadata)||void 0===t?void 0:t.source_language)||e.sourceLanguage||(null===(n=e.metadata)||void 0===n?void 0:n.learning_language)},x=e=>{var t;return(null===(t=e.metadata)||void 0===t?void 0:t.target_language)||e.targetLanguage||k(e)},K="effect",j="tts_sentence",$="tts_word",V="tts_morpheme",L="unknown",q="normal",E="slow",M="howler",S="rate",T="volume",N=u("forced_setting"),R=e=>l(e)&&!!e[N],A=e=>e.value,C=e=>({[N]:!0,value:e}),I=(e,n)=>S===e&&t(n)||T===e&&n>=0&&n<=1,P=(e,n)=>((e,t,n,a=1)=>{if(!l(e))return;const o=u(`${t}_override_version`);a>(Number(e[o])||0)&&Object.defineProperty(e,t,n(Object.getOwnPropertyDescriptor(e,t)))})(HTMLMediaElement,n,(n=>({...n,set:function(a){const l=z[e];t(a)?(this[l.originalValueKey]=a,r(this,l.valueKey)&&(a=this[l.isRelativeKey]?B(e,a*this[l.valueKey]):this[l.valueKey])):R(a)&&(a=A(a)),t(a)&&(this[l.listenerValueKey]=a),n.set.call(this,a)}}))),D=(e,t)=>m("Howl",t,(n=>function(){const a=this,l=arguments,o=z[e];let s=!1;const i=a._queue.length;(1===l.length||2===l.length&&void 0===l[1])&&-1===a._getSoundIds().indexOf(l[0])&&(R(l[0])?(s=!0,l[0]=A(l[0])):I(e,l[0])&&(a[o.originalValueKey]=l[0],r(a,o.valueKey)&&(s=!0,a[o.isRelativeKey]?l[0]=B(e,l[0]*a[o.valueKey]):l[0]=a[o.valueKey])),s&&(a[o.listenerValueKey]=l[0]));const u=n.apply(a,arguments);return s&&i<a._queue.length&&(a._queue[a._queue.length-1].action=function(){l[0]=C(l[0]),a[t](...l)}),u})),H=(e,t,n,a)=>({...a,functions:{audio:{applyOverride:()=>P(e,n),getter:e=>e[t],setter:(e,n)=>e[t]=n,hasQueuedUpdate:()=>!1},[M]:{applyOverride:()=>D(e,n),getter:e=>e[n](),setter:(e,t)=>e[n](t),hasQueuedUpdate:e=>e._queue.find((e=>e.event===n))}},priorityKey:u(`${e}_priority`),isRelativeKey:u(`${e}_is_relative`),valueKey:u(`forced_${e}_value`),originalValueKey:u(`original_${e}_value`),listenerValueKey:u(`${e}_value`)}),z={[S]:H(S,"playbackRate","rate",{minValue:.5,maxValue:4,defaultValue:1}),[T]:H(T,"volume","volume",{minValue:0,maxValue:1,defaultValue:1})},B=(e,t)=>z[e]?Math.max(z[e].minValue,Math.min(t,z[e].maxValue)):t,U="event_listeners",Q=()=>{return`__listener::${e="last_event_listener_id",f(`__counter::${e}__`,(e=>e+1),0)}__`;var e},X=e=>{var t;return(null===(t=c(U,{}))||void 0===t?void 0:t[e])||{}},F=(e,t)=>{f(U,(n=>Object.assign(n||{},{[e]:t})))},J=e=>!s(X(e)),W=(e,t)=>{const n=X(e);return s(n)?null:t(Object.values(n))},G=(e,t,n=Q())=>{const a=X(e);return a[n]=t,F(e,a),()=>Z(e,n)},Y=(e,t,n,l,o=G,r=Q())=>{const s=`__${t}::${e}__`;var i;i=s,X(t)[i]||o(t,((...t)=>{const n=l(...t);a(n)&&ee(e,...n)}),s);const u=G(e,n,r);return()=>{u(),J(e)||Z(t,s)}},Z=(e,t)=>{const n=X(e);delete n[t],F(e,n)},ee=(e,...t)=>W(e,(e=>e.flatMap((e=>{try{return[e(...t)]}catch(e){return[]}})))),te="practice_session_loaded",ne="practice_challenges_loaded",ae="pre_fetched_session_loaded",le="story_loaded",oe="alphabets_loaded",re="forum_discussion_loaded",se="dictionary_lexeme_loaded",ie="sound_initialized",ue={[oe]:/\/[\d]{4}-[\d]{2}-[\d]{2}\/alphabets\/courses\/(?<toLanguage>[^/]+)\/(?<fromLanguage>[^/?]+)\/?/g,[se]:/\/api\/1\/dictionary_page/g,[re]:/\/comments\/([\d]+)/g,[te]:/\/[\d]{4}-[\d]{2}-[\d]{2}\/sessions/g,[le]:/\/api2\/stories/g,user_data_loaded:/\/[\d]{4}-[\d]{2}-[\d]{2}\/users\/[\d]+/g},de=(e,t,n=Q())=>(m("XMLHttpRequest","open",(e=>function(t,n,a,o,r){let s,i;for(const[e,t]of Object.entries(ue))if(i=Array.from(n.matchAll(t))[0],i){s=e;break}return s&&W(s,(e=>{this.addEventListener("load",(()=>{try{const t=l(this.response)?this.response:JSON.parse(this.responseText);e.forEach((e=>e(t,i.groups||{})))}catch(e){w(e,`Could not handle the XHR result (event: ${s}): `)}}))})),e.call(this,t,n,a,o,r)}),2),((e,t,n=1)=>{v(e,o,(()=>_(window,e,t,n)),"global",n)})("fetch",(e=>function(t,n){const a=t instanceof Request?t.url:String(t);let l,o,r=null;for(const[e,t]of Object.entries(ue))if(o=Array.from(a.matchAll(t))[0],o){l=e;break}return l&&(r=W(l,(e=>t=>{try{e.forEach((e=>e(t,o.groups||{})))}catch(e){w(e,`Could not handle the fetch result (event: ${l}): `)}}))),e.call(this,t,n).then((e=>{if(!r)return e;const t=e.clone();return e.json().then((e=>(r(e),t))).catch((()=>t))}))})),G(e,t,n)),ce=(e,t=Q())=>{const a=ae,l=e=>W(a,(t=>{e.addEventListener("success",(()=>{try{t.forEach((t=>t(e.result)))}catch(e){w(e,`Could not handle the IDBRequest result (event: ${a}): `)}}))}));return m("IDBIndex","get",(e=>function(t){const a=e.call(this,t);return n(t)&&t&&"prefetchedSessions"===this.objectStore.name&&l(a),a})),m("IDBObjectStore","get",(e=>function(t){const n=e.call(this,t);return"prefetchedSessions"===this.name&&l(n),n})),G(a,e,t)},pe=e=>{const t=e=>{let t;if(l(e)){var n;t=[{challenges:[e.challenges,e.adaptiveChallenges,null===(n=e.adaptiveInterleavedChallenges)||void 0===n?void 0:n.challenges].filter(a).flat(),sessionMetaData:e.metadata||{}}]}return t},n=Y(ne,te,e,t,de),o=Y(ne,ae,e,t,((e,t,n)=>ce(t,n)));return()=>{n(),o()}},fe=(e,t)=>({url:e,type:j,speed:q,language:t}),ve=(e,t)=>({url:e,type:$,speed:q,language:t}),ge=(e,t)=>({url:e,type:V,speed:q,language:t}),he=Object.fromEntries(["/sounds/7abe057dc8446ad325229edd6d8fd250.mp3","/sounds/2aae0ea735c8e9ed884107d6f0a09e35.mp3","/sounds/421d48c53ad6d52618dba715722278e0.mp3","/sounds/37d8f0b39dcfe63872192c89653a93f6.mp3","/sounds/0a27c1ee63dd220647e8410a0029aed2.mp3","/sounds/a28ff0a501ef5f33ca78c0afc45ee53e.mp3","/sounds/2e4669d8cf839272f0731f8afa488caf.mp3","/sounds/f0b6ab4396d5891241ef4ca73b4de13a.mp3"].map((e=>{return[e,(t=e,{url:t,type:K,speed:q,language:null})];var t}))),_e=/\/duolingo-data\/tts\/(?<language>[a-z-_]+)\/token\//i,me="sound_type_map",ye=()=>c(me,he),be=[L,j,$,V,K],we=[q,E],Oe=(e,t)=>((e,t,n)=>{for(const a of e){const e=Number(a(t,n));if(!isNaN(e)&&0!==e)return e}return 0})([(e,t)=>be.indexOf(e.type)-be.indexOf(t.type),(e,t)=>we.indexOf(e.speed)-we.indexOf(t.speed)],e,t),ke=e=>{const t=ye()||{};for(const n of e){const e=i(n.url);(!t[e]||Oe(n,t[e])>0)&&(t[e]=n)}p(me,t)},xe="sound_detection_listeners_version",Ke="sound_detection_unregistration_callbacks",je=(e,t,n)=>{var a;return{url:e.url,type:t,speed:(null===(a=e.speed)||void 0===a?void 0:a.value)||q,language:n}},$e=()=>{const e=2<=(Number(c(xe))||0);var t,o,r,s,i;!!c(Ke)&&e||(e||Ve(),p(xe,2),p(Ke,[(i=e=>(e=>{const t=e.learningLanguage;a(null==e?void 0:e.elements)&&ke(e.elements.map((e=>{var t;return(null==e||null===(t=e.line)||void 0===t?void 0:t.content)||(null==e?void 0:e.learningLanguageTitleContent)})).flatMap((e=>[null==e?void 0:e.audio,null==e?void 0:e.audioPrefix,null==e?void 0:e.audioSuffix])).map((e=>null==e?void 0:e.url)).filter(n).map((e=>fe(e,t))))})(e),de(le,i)),(r=(e,t)=>((e,t)=>{const l=t.toLanguage;a(null==e?void 0:e.alphabets)&&n(null==t?void 0:t.toLanguage)&&ke(e.alphabets.flatMap((e=>null==e?void 0:e.groups)).flatMap((e=>null==e?void 0:e.characters)).flat().map((e=>null==e?void 0:e.ttsUrl)).filter(n).map((e=>ge(e,l))))})(e,t),de(oe,r,s)),(o=e=>{var t;n(null==(t=e)?void 0:t.tts_url)&&ke([fe(t.tts_url,t.sentence_language)])},de(re,o)),(t=e=>(e=>{const t=[],l=e.learning_language;n(e.tts)&&t.push(ve(e.tts,l)),a(e.alternative_forms)&&t.push(e.alternative_forms.map((e=>null==e?void 0:e.tts)).filter(n).map((e=>fe(e,l)))),ke(t.flat())})(e),de(se,t)),pe((e=>(e=>{const t=[];for(const i of e){var o;const e=i.type,u=k(i),d=x(i);if(n(i.tts)){const n=O.indexOf(e)>=0?ge:fe;t.push(n(i.tts,u))}if(n(i.slowTts)&&t.push({url:i.slowTts,type:j,speed:E,language:u}),n(i.solutionTts)&&t.push(fe(i.solutionTts,d)),a(i.choices)){const a=-1===O.indexOf(e)?ve:ge;t.push(i.choices.map((e=>null==e?void 0:e.tts)).filter(n).map((e=>a(e,d))))}if(a(i.tokens)&&t.push(i.tokens.map((e=>null==e?void 0:e.tts)).filter(n).map((e=>ve(e,u)))),a(i.questionTokens)&&t.push(i.questionTokens.map((e=>null==e?void 0:e.tts)).filter(n).map((e=>ve(e,d)))),a(null===(o=i.metadata)||void 0===o?void 0:o.speakers))for(const e of i.metadata.speakers){var r,s;l(null===(r=e.tts)||void 0===r?void 0:r.tokens)&&t.push(Object.values(e.tts.tokens).filter((e=>n(e.url))).map((e=>je(e,$,d)))),a(null===(s=e.tts)||void 0===s?void 0:s.sentence)&&t.push(e.tts.sentence.filter((e=>n(e.url))).map((e=>je(e,j,d))))}if(a(i.pairs)){const a=-1===O.indexOf(e)?ve:ge;t.push(i.pairs.map((e=>null==e?void 0:e.tts)).filter(n).map((e=>a(e,d))))}a(i.options)&&t.push(i.options.map((e=>null==e?void 0:e.tts)).filter(n).map((e=>ve(e,d))))}ke(t.flat())})(e.challenges)))]))},Ve=()=>{const e=c(Ke);!a(e)||J(ie)||J("sound_playback_requested")||J("sound_playback_cancelled")||J("sound_playback_confirmed")||(e.forEach((e=>e())),p(xe,null),p(Ke,null))},Le=(e,t,n)=>{const a=(e=>{const t=ye()[e];if(l(t))return t;const n=e.match(_e);return n?ve(e,n.language):null})(i(t));return{url:t,type:(null==a?void 0:a.type)||L,speed:(null==a?void 0:a.speed)||q,language:null==a?void 0:a.language,playbackStrategy:n,sound:e}};(e=>{m("Howl","init",(e=>function(t){var n;p("is_howler_used",!0);const a=e.call(this,t),l=String(this._src||(null===(n=this._parent)||void 0===n?void 0:n._src)||"").trim();return""!==l&&ee(ie,Le(this,l,M)),a})),$e();const t=G(ie,e)})(e)}();
